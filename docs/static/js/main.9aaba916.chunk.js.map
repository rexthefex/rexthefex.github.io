{"version":3,"sources":["useLocalStorage.js","App.js","index.js"],"names":["useLocalStorage","key","initialValue","useState","item","window","localStorage","getItem","JSON","parse","error","console","log","storedValue","setStoredValue","value","valueToStore","Function","setItem","stringify","axios","defaults","baseURL","Timer","minutes","setItems","seconds","setSeconds","setItemsRef","useRef","current","useEffect","interval","setInterval","clearInterval","fetch","useCallback","a","get","then","r","newItems","length","splice","unshift","timestamp","dayjs","unix","data","map","el","symbol","volume","quoteVolume","lastPrice","Refresher","setMinutes","inputMinutes","setInputMinutes","className","onChange","event","parseInt","target","type","onClick","disabled","isNaN","App","items","columns","useMemo","res","Header","accessor","sticky","forEach","idx","push","toString","format","availableCoinsInUSDT","filter","includes","endsWith","replace","filteredUSDTCoins","parseFloat","sort","b","filteredItems","some","coin","href","currentItem","find","dataItem","previousItem","ts","Math","round","toFixed","change","useTable","initialState","sortBy","id","desc","useSortBy","useSticky","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","striped","bordered","hover","size","headerGroup","getHeaderGroupProps","headers","column","style","display","justifyContent","getHeaderProps","getSortByToggleProps","render","isSorted","isSortedDesc","row","getRowProps","cells","cell","getCellProps","ReactDOM","StrictMode","document","getElementById"],"mappings":"0SAEaA,EAAkB,SAACC,EAAKC,GAAiB,MAGfC,oBAAS,WAC9C,IAEC,IAAMC,EAAOC,OAAOC,aAAaC,QAAQN,GAEzC,OAAOG,EAAOI,KAAKC,MAAML,GAAQF,EAChC,MAAOQ,GAGR,OADAC,QAAQC,IAAIF,GACLR,MAZ4C,mBAG9CW,EAH8C,KAGjCC,EAHiC,KAiCrD,MAAO,CAACD,EAfS,SAAAE,GAChB,IAEC,IAAMC,EACLD,aAAiBE,SAAWF,EAAMF,GAAeE,EAElDD,EAAeE,GAEfX,OAAOC,aAAaY,QAAQjB,EAAKO,KAAKW,UAAUH,IAC/C,MAAON,GAERC,QAAQC,IAAIF,O,+BCtBfU,IAAMC,SAASC,QAAU,0BAEzB,IAAMC,EAAQ,SAAC,GAAyB,IAAxBC,EAAuB,EAAvBA,QAASC,EAAc,EAAdA,SAAc,EACPtB,mBAAmB,GAAVqB,GADF,mBAC9BE,EAD8B,KACrBC,EADqB,KAE/BC,EAAcC,iBAAOJ,GAC3BG,EAAYE,QAAUL,EAEtBM,qBAAU,WACR,IAAMC,EAAWC,aAAY,WAC3BN,GAAW,SAAAG,GAAO,OAAIA,EAAU,OAC/B,KACH,OAAO,kBAAMI,cAAcF,MAC1B,IAEH,IAAMG,EAAQC,sBAAW,sBAAC,sBAAAC,EAAA,+EAGjBjB,IAAMkB,IAAI,uBAAuBC,MAAK,SAACC,GAAD,OAC3CZ,EAAYE,SAAQ,SAACA,GACnB,IAAMW,EAAQ,YAAOX,GAYrB,OAXIA,EAAQY,OAAS,IACnBD,EAASE,OAAO,EAAGb,EAAQY,OAAS,GAEtCD,EAASG,QAAQ,CACfC,UAAWC,MAAQC,OACnBC,KAAMR,EAAEQ,KAAKC,KAAI,SAACC,GAAD,MAAS,CACxBC,OAAQD,EAAGC,OACXC,OAAQF,EAAGG,YACXC,UAAWJ,EAAGI,gBAGXb,SAjBa,2CAoBvB,IAYH,OAVAV,qBAAU,WACQ,IAAZL,GACFS,IAAQI,MAAK,kBAAMZ,EAAqB,GAAVH,QAE/B,CAACW,EAAOX,EAASE,IAEpBK,qBAAU,WACRI,IAAQI,MAAK,kBAAMZ,EAAqB,GAAVH,QAC7B,CAACW,EAAOX,IAEJ,8BAAME,KAGT6B,EAAY,SAAC,GAAgB,IAAf9B,EAAc,EAAdA,SAAc,EACFzB,EAAgB,WAAY,GAD1B,mBACzBwB,EADyB,KAChBgC,EADgB,OAEQrD,mBAAS,GAFjB,mBAEzBsD,EAFyB,KAEXC,EAFW,KAIhC,OAAO,sBAAKC,UAAW,iBAAhB,UACL,4CAAc,uBAAO5C,MAAO0C,EAClBG,SAAU,SAAAC,GAAK,OAAIH,EAAgBI,SAASD,EAAME,OAAOhD,SACzDiD,KAAM,WACd,wBAAQC,QAAS,kBAAMT,EAAWC,IAC1BS,SAAUC,MAAMV,GADxB,qBAIF,cAAC,EAAD,CAAOjC,QAASA,EAASC,SAAUA,QA2KxB2C,MAvKf,WAAgB,IAAD,EACapE,EAAgB,QAAS,IADtC,mBACNqE,EADM,KACC5C,EADD,KAEP6C,EAAUC,mBAAQ,WACtB,IAAIC,EAAM,CACR,CAAEC,OAAQ,SAAUC,SAAU,SAAUC,OAAQ,SAoBlD,OAlBK,OAALN,QAAK,IAALA,KAAOO,SAAQ,SAAC1B,EAAI2B,GACN,IAARA,IACFL,EAAIM,KAAK,CACPL,OAAQ,MACRC,SAAUxB,EAAGL,UAAUkC,WAAa,QAEtCP,EAAIM,KAAK,CACPL,OAAQ,MACRC,SAAUxB,EAAGL,UAAUkC,WAAa,SAGxCP,EAAIM,KAAK,CACPL,OAAQvB,EAAGL,UACPC,IAAMC,KAAKG,EAAGL,WAAWmC,OAAO,YAChC,KACJN,SAAUxB,EAAGL,UAAUkC,gBAGpBP,IACN,CAACH,IAEEY,EAAuBV,mBAAQ,WAAO,IAAD,EACzC,cAAOF,QAAP,IAAOA,GAAP,UAAOA,GAAa,OAALA,QAAK,IAALA,OAAA,EAAAA,EAAO3B,QAAS,UAA/B,aAAO,EAA4BM,KAChCkC,QAAO,SAAChC,GAAD,OAAQA,EAAGC,OAAOgC,SAAS,WAClCD,QACC,SAAChC,GAAD,OACGA,EAAGC,OAAOgC,SAAS,UACnBjC,EAAGC,OAAOgC,SAAS,UACnBjC,EAAGC,OAAOgC,SAAS,QACnBjC,EAAGC,OAAOgC,SAAS,WAEvBD,QAAO,SAAChC,GAAD,OAAQA,EAAGC,OAAOiC,SAAS,WAClCnC,KAAI,SAACC,GAAD,MAAS,CACZC,OAAQD,EAAGC,OAAOkC,QAAQ,OAAQ,IAClCjC,OAAQF,EAAGE,aAEd,CAACiB,IAEEiB,EAAoBf,mBACxB,yBACEU,QADF,IACEA,OADF,EACEA,EACIC,QAAO,SAAChC,GAAD,OAAQqC,WAAWrC,EAAGE,QAAU,OACxCoC,MAAK,SAACnD,EAAGoD,GAAJ,OAAUF,WAAWE,EAAErC,QAAUmC,WAAWlD,EAAEe,aACxD,CAAC6B,IAGGS,EAAgBnB,mBAAQ,WAAO,IAAD,EAC5BvB,EAAI,OAAGqB,QAAH,IAAGA,GAAH,UAAGA,EAAQA,EAAM3B,OAAS,UAA1B,aAAG,EAA2BM,KACxC,OAAW,OAAJA,QAAI,IAAJA,OAAA,EAAAA,EAAMkC,QACX,SAAChC,GAAD,OACEA,EAAGC,OAAOgC,SAAS,QACnBG,EAAkBK,MAAK,SAACC,GAAD,OAAU1C,EAAGC,OAAOgC,SAASS,EAAKzC,gBACxD,KACJ,CAACmC,EAAmBjB,IAEjBrB,EAAOuB,mBACX,kBACEmB,EAAczC,KAAI,SAACC,GACjB,IAAMC,EAASD,EAAGC,OACZH,EAAO,CAAEG,OAAQ,mBAAG0C,KAAM,oCAAsC3C,EAAGC,OAAQY,OAAQ,SAAlE,SAA6Eb,EAAGC,UAsBvG,OArBAkB,EAAMO,SAAQ,SAACxE,EAAMyE,GAAS,IAAD,EACrBiB,EAAc1F,EAAK4C,KAAK+C,MAC5B,SAACC,GAAD,OAAcA,EAAS7C,SAAWA,KAE9B8C,EAAY,UAAG5B,EAAMQ,EAAI,UAAb,aAAG,EAAc7B,KAAK+C,MACtC,SAACC,GAAD,OAAcA,EAAS7C,SAAWA,KAE9B+C,EAAK9F,EAAKyC,UAAUkC,YAC1B,OAAIe,QAAJ,IAAIA,OAAJ,EAAIA,EAAaxC,UAAU8B,SAAS,WAClCpC,EAAKkD,GAAL,OAAWJ,QAAX,IAAWA,OAAX,EAAWA,EAAaxC,UAAU+B,QAAQ,SAAU,IAEpDrC,EAAKkD,GAAL,OAAWJ,QAAX,IAAWA,OAAX,EAAWA,EAAaxC,UAAU+B,QAAQ,WAAY,IAExDrC,EAAKkD,EAAK,QAAWC,KAAKC,OAAkB,OAAZH,QAAY,IAAZA,OAAA,EAAAA,EAAc7C,SAAd,OAC9B0C,QAD8B,IAC9BA,OAD8B,EAC9BA,EAAa1C,QAAS,KAAQ,GAAM,KAAKiD,QAAQ,GAAK,IACxD,IAAMC,EAAUH,KAAKC,OAAkB,OAAZH,QAAY,IAAZA,OAAA,EAAAA,EAAc3C,YAAd,OACzBwC,QADyB,IACzBA,OADyB,EACzBA,EAAaxC,WAAY,KAAQ,GAAM,IAC1B,IAAXgD,IACFtD,EAAKkD,EAAK,OAASI,EAAOD,QAAQ,GAAK,QAGpCrD,MACH,KACR,CAACqB,IAzFU,EAoGTkC,mBACF,CACEjC,UACAtB,OACAwD,aAAc,CACZC,OAAQ,CACN,CACEC,GAAI,SACJC,MAAM,MAMdC,YACAC,aApBAC,EA/FW,EA+FXA,cACAC,EAhGW,EAgGXA,kBACAC,EAjGW,EAiGXA,aACAC,EAlGW,EAkGXA,KACAC,EAnGW,EAmGXA,WAmBF,OACE,qCACE,cAAC,EAAD,CAAWzF,SAAUA,IACvB,eAAC,IAAD,yBAAQ0F,SAAO,EAACC,UAAQ,EAACC,OAAK,EAACC,KAAK,MAASR,KAA7C,IAA8DnD,UAAW,eAAzE,UACE,uBAAOA,UAAW,SAAlB,SACGqD,EAAa/D,KAAI,SAACsE,GAAD,OAChB,8CAAQA,EAAYC,uBAApB,aACGD,EAAYE,QAAQxE,KAAI,SAACyE,GAAD,OACvB,6BACE,sBAAKC,MAAO,CAAEC,QAAS,OAAQC,eAAgB,iBAA/C,UACE,gDAASH,EAAOI,eAAeJ,EAAOK,yBAAtC,cACGL,EAAOM,OAAO,UACdN,EAAOO,SAAYP,EAAOQ,aAAe,eAAO,eAAQ,QAEzD/D,MAAMuD,EAAOhB,KAAO,mBAAGb,KAAK,IAAI5B,QAAS,kBACzCxC,GAAS,SAAAK,GACP,IAAM+C,EAAM/C,EAAQiE,MAClB,SAAA7C,GAAE,OAAIA,EAAGL,aAAe6E,EAAOhB,MACjC,IAAa,IAAT7B,EAAY,CACd,IAAMpC,EAAQ,YAAOX,GAErB,OADAW,EAASE,OAAOkC,EAAK,GACdpC,OAPS,+BAiBlC,iDAAWsE,KAAX,aACGE,EAAKhE,KAAI,SAACkF,GAET,OADAjB,EAAWiB,GAET,8CAAQA,EAAIC,eAAZ,aACGD,EAAIE,MAAMpF,KAAI,SAACqF,EAAMzD,GAAP,OACb,8CAAQyD,EAAKC,gBAAb,aAA8BD,EAAKN,OAAO,+BChO1DQ,IAASR,OACP,cAAC,IAAMS,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,W","file":"static/js/main.9aaba916.chunk.js","sourcesContent":["import { useState } from \"react\";\n\nexport const useLocalStorage = (key, initialValue) => {\n\t// State to store our value\n\t// Pass initial state function to useState so logic is only executed once\n\tconst [storedValue, setStoredValue] = useState(() => {\n\t\ttry {\n\t\t\t// Get from local storage by key\n\t\t\tconst item = window.localStorage.getItem(key);\n\t\t\t// Parse stored json or if none return initialValue\n\t\t\treturn item ? JSON.parse(item) : initialValue;\n\t\t} catch (error) {\n\t\t\t// If error also return initialValue\n\t\t\tconsole.log(error);\n\t\t\treturn initialValue;\n\t\t}\n\t});\n\n\t// Return a wrapped version of useState's setter function that ...\n\t// ... persists the new value to localStorage.\n\tconst setValue = value => {\n\t\ttry {\n\t\t\t// Allow value to be a function so we have same API as useState\n\t\t\tconst valueToStore =\n\t\t\t\tvalue instanceof Function ? value(storedValue) : value;\n\t\t\t// Save state\n\t\t\tsetStoredValue(valueToStore);\n\t\t\t// Save to local storage\n\t\t\twindow.localStorage.setItem(key, JSON.stringify(valueToStore));\n\t\t} catch (error) {\n\t\t\t// A more advanced implementation would handle the error case\n\t\t\tconsole.log(error);\n\t\t}\n\t};\n\n\treturn [storedValue, setValue];\n};\n","import { useTable, useSortBy } from \"react-table\";\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport axios from \"axios\";\nimport BTable from \"react-bootstrap/Table\";\nimport { useLocalStorage } from \"./useLocalStorage\";\nimport dayjs from \"dayjs\";\nimport { useSticky } from \"react-table-sticky\";\nimport './App.css';\n\naxios.defaults.baseURL = \"https://api.binance.com\";\n\nconst Timer = ({minutes, setItems}) => {\n  const [seconds, setSeconds] = useState(minutes * 60);\n  const setItemsRef = useRef(setItems);\n  setItemsRef.current = setItems;\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setSeconds(current => current - 1)\n    }, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const fetch = useCallback(async () => {\n    // console.log('fetch')\n    // return true;\n    return axios.get(\"/api/v3/ticker/24hr\").then((r) =>\n      setItemsRef.current((current) => {\n        const newItems = [...current];\n        if (current.length > 10) {\n          newItems.splice(9, current.length - 9);\n        }\n        newItems.unshift({\n          timestamp: dayjs().unix(),\n          data: r.data.map((el) => ({\n            symbol: el.symbol,\n            volume: el.quoteVolume,\n            lastPrice: el.lastPrice,\n          })),\n        });\n        return newItems;\n      }),\n    );\n  }, []);\n\n  useEffect(() => {\n    if (seconds === 0) {\n      fetch().then(() => setSeconds(minutes * 60));\n    }\n  }, [fetch, minutes, seconds]);\n\n  useEffect(() => {\n    fetch().then(() => setSeconds(minutes * 60));\n  }, [fetch, minutes]);\n\n  return <div>{seconds}</div>;\n}\n\nconst Refresher = ({setItems}) => {\n  const [minutes, setMinutes] = useLocalStorage('interval', 1);\n  const [inputMinutes, setInputMinutes] = useState(1);\n\n  return <div className={'refresh-header'}>\n    <div>Minutes: <input value={inputMinutes}\n              onChange={event => setInputMinutes(parseInt(event.target.value))}\n              type={\"number\"}/>\n      <button onClick={() => setMinutes(inputMinutes)}\n              disabled={isNaN(inputMinutes)}>Save\n      </button>\n    </div>\n    <Timer minutes={minutes} setItems={setItems} />\n</div>\n}\n\nfunction App() {\n  const [items, setItems] = useLocalStorage(\"items\", []);\n  const columns = useMemo(() => {\n    let res = [\n      { Header: \"Symbol\", accessor: \"symbol\", sticky: 'left' },\n    ];\n    items?.forEach((el, idx) => {\n      if (idx !== 0) {\n        res.push({\n          Header: 'CHG',\n          accessor: el.timestamp.toString() + 'CHG',\n        });\n        res.push({\n          Header: 'VOL',\n          accessor: el.timestamp.toString() + 'VOL',\n        });\n      }\n      res.push({\n        Header: el.timestamp\n          ? dayjs.unix(el.timestamp).format(\"HH:mm:ss\")\n          : null,\n        accessor: el.timestamp.toString(),\n      });\n    });\n    return res;\n  }, [items]);\n\n  const availableCoinsInUSDT = useMemo(() => {\n    return items?.[items?.length - 1]?.data\n      .filter((el) => el.symbol.includes(\"USDT\"))\n      .filter(\n        (el) =>\n          !el.symbol.includes(\"BULL\") &&\n          !el.symbol.includes(\"BEAR\") &&\n          !el.symbol.includes(\"UP\") &&\n          !el.symbol.includes(\"DOWN\")\n      )\n      .filter((el) => el.symbol.endsWith(\"USDT\"))\n      .map((el) => ({\n        symbol: el.symbol.replace(\"USDT\", \"\"),\n        volume: el.volume,\n      }));\n  }, [items]);\n\n  const filteredUSDTCoins = useMemo(\n    () =>\n      availableCoinsInUSDT\n        ?.filter((el) => parseFloat(el.volume) > 100000)\n        .sort((a, b) => parseFloat(b.volume) - parseFloat(a.volume)),\n    [availableCoinsInUSDT]\n  );\n\n  const filteredItems = useMemo(() => {\n    const data = items?.[items.length - 1]?.data;\n    return data?.filter(\n      (el) =>\n        el.symbol.includes(\"BTC\") &&\n        filteredUSDTCoins.some((coin) => el.symbol.includes(coin.symbol))\n    ) || [];\n  }, [filteredUSDTCoins, items]);\n\n  const data = useMemo(\n    () =>\n      filteredItems.map((el) => {\n        const symbol = el.symbol;\n        const data = { symbol: <a href={'https://www.binance.com/en/trade/' + el.symbol} target={'_blank'}>{el.symbol}</a> };\n        items.forEach((item, idx) => {\n          const currentItem = item.data.find(\n            (dataItem) => dataItem.symbol === symbol\n          );\n          const previousItem = items[idx-1]?.data.find(\n            (dataItem) => dataItem.symbol === symbol\n          )\n          const ts = item.timestamp.toString();\n          if (currentItem?.lastPrice.endsWith('000000')) {\n            data[ts] = currentItem?.lastPrice.replace('000000', '');\n          } else {\n            data[ts] = currentItem?.lastPrice.replace('00000000', '');\n          }\n          data[ts + 'VOL'] = ((Math.round(previousItem?.volume /\n            currentItem?.volume * 1000) / 10) - 100).toFixed(1) + '%';\n          const change = (Math.round(previousItem?.lastPrice /\n            currentItem?.lastPrice * 1000) / 10) - 100;\n          if (change !== 0.0) {\n            data[ts + 'CHG'] = change.toFixed(1) + '%';\n          }\n        });\n        return data;\n      }) || [],\n    [items]\n  );\n\n  // console.log({ columns, data, filteredUSDTCoins, filteredItems, items });\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = useTable(\n    {\n      columns,\n      data,\n      initialState: {\n        sortBy: [\n          {\n            id: 'Symbol',\n            desc: false,\n          }\n        ]\n      }\n\n    },\n    useSortBy,\n    useSticky\n  );\n\n  return (\n    <>\n      <Refresher setItems={setItems} />\n    <BTable striped bordered hover size=\"sm\" {...getTableProps()} className={\"table sticky\"}>\n      <thead className={\"header\"}>\n        {headerGroups.map((headerGroup) => (\n          <tr {...headerGroup.getHeaderGroupProps()}>\n            {headerGroup.headers.map((column) => (\n              <th>\n                <div style={{ display: \"flex\", justifyContent: \"space-between\"}}>\n                  <div {...column.getHeaderProps(column.getSortByToggleProps())}>\n                    {column.render(\"Header\")}\n                    {column.isSorted ? (column.isSortedDesc ? \"🔽\" : \"🔼\") : \"\"}\n                  </div>\n                  {!isNaN(column.id) && <a href='#' onClick={() =>\n                    setItems(current => {\n                      const idx = current.find(\n                        el => el.timestamp === +column.id);\n                      if (idx !== -1) {\n                        const newItems = [...current];\n                        newItems.splice(idx, 1);\n                        return newItems;\n                      }\n                    })}>X\n                  </a>}\n                </div>\n              </th>\n            ))}\n          </tr>\n        ))}\n      </thead>\n      <tbody {...getTableBodyProps()}>\n        {rows.map((row) => {\n          prepareRow(row);\n          return (\n            <tr {...row.getRowProps()}>\n              {row.cells.map((cell, idx) => (\n                <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>\n              ))}\n            </tr>\n          );\n        })}\n      </tbody>\n    </BTable>\n    </>\n\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n"],"sourceRoot":""}